# üéØ Cerberus - Judge Presentation Guide

## üöÄ System Overview

**Cerberus** is an AI-powered Deceptive Defense Platform that combines:
1. **Machine Learning** - Real-time threat detection using Isolation Forest + LSTM
2. **Honeypot Technology** - Deceptive decoy APIs to attract and analyze attackers  
3. **Automated Intelligence** - Auto-generated WAF rules from threat simulations
4. **Observability** - Full-stack monitoring with Prometheus + Grafana

---

## üìä Key Statistics to Highlight

- **102 ML Features** extracted per request
- **Isolation Forest** with 100 estimators for anomaly detection
- **LSTM Behavioral Classifier** for session analysis
- **Docker Sandbox** isolation for safe payload simulation
- **S3-Compatible Storage** for forensic evidence
- **Real-time Metrics** via Prometheus

---

## üé¨ Demo Flow (10 Minutes)

### Part 1: AI Threat Detection (3 mins)

#### Show ML Model is Active
```bash
curl -s http://localhost:8000/api/v1/gatekeeper/ml-model | python3 -m json.tool
```
**Point out:**
- Isolation Forest loaded with 100 estimators
- 102 features across 6 categories
- Model is production-ready

#### Normal Request (Baseline)
```bash
curl -s -X POST http://localhost:8000/api/v1/gatekeeper/analyze-features \
  -H "Content-Type: application/json" \
  -d '{
    "method": "GET",
    "url": "http://example.com/api/users",
    "headers": {"User-Agent": "Mozilla/5.0"},
    "body": "",
    "query_params": {},
    "client_ip": "192.168.1.100",
    "session_id": "normal-demo"
  }' | python3 -m json.tool
```
**Highlight:**
- ML anomaly score: ~0.74 (medium, not flagged)
- ModSecurity score: 0 (no attack patterns)
- Action: **"allow"**
- SQL/XSS patterns: **0**

#### SQL Injection Attack (AI Detection)
```bash
curl -s -X POST http://localhost:8000/api/v1/gatekeeper/analyze-features \
  -H "Content-Type: application/json" \
  -d '{
    "method": "GET",
    "url": "http://example.com/api/users?id=1 UNION SELECT password FROM users",
    "headers": {"User-Agent": "sqlmap/1.0"},
    "body": "",
    "query_params": {"id": "1 UNION SELECT password FROM users"},
    "client_ip": "192.168.1.100",
    "session_id": "attack-demo"
  }' | python3 -m json.tool
```
**Highlight:**
- ML anomaly score: **0.767** (high!)
- ModSecurity score: **90** (critical attack detected)
- Action: **"tag_poi"** (Person of Interest)
- SQL patterns: **3** detected
- User-Agent: **sqlmap** scanner detected
- Top features show URL length, entropy, SQL keywords

**KEY MESSAGE:** The AI model is actively analyzing and detecting threats in real-time!

---

### Part 2: Honeypot Deception (2 mins)

#### Fake User Data
```bash
curl -s http://localhost:8002/api/v1/users?limit=3 | python3 -m json.tool
```
**Point out:**
- Realistic fake users with names, emails, roles
- Appears as legitimate internal portal
- Generated by Faker library (100% synthetic)

#### Fake Admin Panel (Honeytrap)
```bash
curl -s http://localhost:8002/admin/config | python3 -m json.tool
```
**Highlight:**
- Fake credentials exposed
- Database connection strings (fake)
- Attracts attackers trying to escalate privileges
- All interactions are logged for analysis

#### Fake .env File Disclosure
```bash
curl -s http://localhost:8002/.env | head -10
```
**Point out:**
- Fake API keys and secrets
- Honeytokens embedded
- Captures reconnaissance attempts

**KEY MESSAGE:** Labyrinth wastes attacker time while gathering intelligence!

---

### Part 3: Threat Intelligence & Simulation (3 mins)

#### Trigger Payload Simulation
```bash
curl -s -X POST http://localhost:8003/api/v1/sentinel/simulate \
  -H "Content-Type: application/json" \
  -H "X-API-Key: sentinel-dev-key-change-me" \
  -d '{
    "payload": {"type": "sql_injection", "value": "1 OR 1=1", "confidence": 0.9},
    "shadow_app_ref": "main",
    "metadata": {}
  }' | python3 -m json.tool
```
**Highlight:**
- Job queued for async execution
- Runs in isolated Docker sandbox
- Returns job_id for tracking

#### View Simulation Results (after 5 sec)
```bash
# Get the job ID from previous response
JOB_ID="..." # From above
curl -s "http://localhost:8003/api/v1/sentinel/sim-result/$JOB_ID" | python3 -m json.tool
```
**Point out:**
- Verdict (exploit_possible, exploit_improbable, etc.)
- Execution time in milliseconds
- Behavioral analysis
- Sandbox isolation prevents damage

#### Auto-Generated WAF Rules
```bash
curl -s http://localhost:8003/api/v1/sentinel/rules | python3 -m json.tool
```
**Highlight:**
- Rules auto-generated from simulations
- Confidence scores
- MITRE ATT&CK mapping
- Ready for deployment to Gatekeeper

**KEY MESSAGE:** Sentinel automates threat intelligence and rule generation!

---

### Part 4: Observability (2 mins)

#### Prometheus Metrics
```bash
# Show all services are being monitored
curl -s 'http://localhost:9090/api/v1/query?query=up' | python3 -m json.tool
```

#### Grafana Dashboard
- Open browser: `http://localhost:3001` (admin/admin)
- Navigate to Cerberus Overview Dashboard
- Show real-time graphs:
  - Request rate over time
  - Threat detection timeline  
  - ML anomaly scores
  - Service health status

#### MinIO Evidence Storage
- Open browser: `http://localhost:9001` (cerberus/cerberus_minio_password)
- Show evidence packages stored
- Highlight S3-compatible storage for forensics

**KEY MESSAGE:** Full observability with production-grade monitoring!

---

## üéØ Key Technical Points for Judges

### 1. Machine Learning Architecture
- **Feature Extraction**: 102 features per request
  - Basic (10): method, URL length, header count
  - Content (20): character ratios, entropy
  - Patterns (25): SQL, XSS, command injection
  - Entropy (15): randomness analysis
  - Behavioral (20): session history
  - Headers (12): User-Agent analysis

- **Anomaly Detection**: Isolation Forest
  - Unsupervised learning
  - Detects outliers in high-dimensional space
  - 0.1 contamination rate (10% expected anomalies)

- **Behavioral Analysis**: LSTM
  - Analyzes session request sequences
  - Detects progressive attack patterns
  - 10-request history window

### 2. Deception Technology
- **Labyrinth Honeypot**
  - Fake APIs mimic real enterprise portals
  - Decoy data attracts lateral movement
  - Captures attack TTPs (Tactics, Techniques, Procedures)

### 3. Threat Intelligence Automation
- **Sentinel AI Engine**
  - Docker sandbox isolation
  - Payload simulation in safe environment
  - Auto-rule generation from observations
  - MITRE ATT&CK framework mapping

### 4. Production Readiness
- **Containerized Architecture**: Docker Compose for easy deployment
- **Scalable Storage**: MinIO S3-compatible object storage
- **Message Bus**: Kafka for event streaming
- **Caching**: Redis for session management
- **Database**: PostgreSQL for persistent data
- **Monitoring**: Prometheus + Grafana stack

---

## üí° Unique Selling Points

1. **AI-First Approach**: Not just signatures - ML learns attack patterns
2. **Active Defense**: Honeypot wastes attacker time while gathering intel
3. **Automation**: Auto-generates WAF rules from real attack simulations
4. **Evidence Chain**: S3-stored packages with cryptographic integrity
5. **Production-Ready**: Full observability, auth, and deployment configs

---

## ‚ö†Ô∏è Common Questions & Answers

**Q: How does this differ from traditional WAF?**
A: Traditional WAF uses static signatures. Cerberus uses ML to detect novel attacks and honeypots to gather intelligence.

**Q: What about false positives?**
A: Multi-layer approach (WAF + ML + Behavioral) reduces false positives. POI tagging instead of immediate blocking allows investigation.

**Q: Can this scale?**
A: Yes - containerized architecture, horizontal scaling via Kubernetes, distributed storage with MinIO.

**Q: Is the ML model trained?**
A: Currently using pre-trained Isolation Forest. In production, continuous learning from captured traffic + honeypot data.

**Q: What about zero-day attacks?**
A: ML anomaly detection can identify unusual patterns even without signatures. Honeypot captures novel TTPs.

---

## üé¨ Backup Demos (If Time Permits)

### XSS Attack Detection
```bash
curl -s -X POST http://localhost:8000/api/v1/gatekeeper/analyze-features \
  -H "Content-Type: application/json" \
  -d '{
    "method": "POST",
    "url": "http://example.com/comment",
    "headers": {"User-Agent": "Chrome"},
    "body": "<script>alert(document.cookie)</script>",
    "query_params": {},
    "client_ip": "1.2.3.4",
    "session_id": "xss-demo"
  }' | python3 -m json.tool
```

### Path Traversal Detection
```bash
curl -s -X POST http://localhost:8000/api/v1/gatekeeper/analyze-features \
  -H "Content-Type: application/json" \
  -d '{
    "method": "GET",
    "url": "http://example.com/file?path=../../../etc/passwd",
    "headers": {"User-Agent": "curl"},
    "body": "",
    "query_params": {"path": "../../../etc/passwd"},
    "client_ip": "1.2.3.4",
    "session_id": "traversal-demo"
  }' | python3 -m json.tool
```

---

## üì∏ Visual Aids for Presentation

1. **Architecture Diagram**: Show dataflow from request ‚Üí Gatekeeper ‚Üí Switch ‚Üí Labyrinth/Production ‚Üí Sentinel
2. **ML Feature Heatmap**: Visualize 102 features extracted
3. **Grafana Dashboard**: Live metrics and graphs
4. **MinIO Console**: Evidence package storage
5. **Prometheus Targets**: All services monitored

---

## üé§ Closing Statement

"Cerberus represents the future of cybersecurity - combining AI-powered detection, deceptive defense, and automated threat intelligence. Unlike traditional security solutions that react to known threats, Cerberus proactively learns, adapts, and gathers intelligence. Thank you!"

---

## üìã Quick Reference Commands

```bash
# Start system
cd /Users/mishragaurav/Documents/Cerberus
docker compose up -d

# Health checks
curl http://localhost:8000/health  # Gatekeeper
curl http://localhost:8001/health  # Switch
curl http://localhost:8002/health  # Labyrinth
curl http://localhost:8003/health  # Sentinel

# ML model info
curl http://localhost:8000/api/v1/gatekeeper/ml-model | python3 -m json.tool

# Test attack detection
curl -X POST http://localhost:8000/api/v1/gatekeeper/analyze-features \
  -H "Content-Type: application/json" \
  -d '{"method":"GET","url":"http://test.com?id=1 OR 1=1","headers":{"User-Agent":"sqlmap"},"body":"","query_params":{},"client_ip":"1.2.3.4","session_id":"demo"}' \
  | python3 -m json.tool

# Trigger simulation
curl -X POST http://localhost:8003/api/v1/sentinel/simulate \
  -H "Content-Type: application/json" \
  -H "X-API-Key: sentinel-dev-key-change-me" \
  -d '{"payload":{"type":"sql_injection","value":"1 OR 1=1","confidence":0.9},"shadow_app_ref":"main","metadata":{}}' \
  | python3 -m json.tool

# Grafana: http://localhost:3001 (admin/admin)
# MinIO: http://localhost:9001 (cerberus/cerberus_minio_password)
# Prometheus: http://localhost:9090
```
